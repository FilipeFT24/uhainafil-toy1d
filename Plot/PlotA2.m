function [obj] = PlotA2(g)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Color = linspecer(9, 'Qualitative');
grey  = repmat(0.80, 1, 3);
LW    = [1.0, 2.5];
%--------------------------------------------------------------------------
xv    = g.data.xv;
CFL   = g.CFL;
K     = g.numE;
N     = g.N;
test  = g.test;
xc    = zeros(K, 1);
for i = 1:K
    xc(i, 1) = 1./2.*(xv(i, 1)+xv(i+1, 1));
end
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
switch test
    case {6, 7}
        switch test
            case 6
                %----------------------------------------------------------
                path       = "Plot/T06 - Head-on-colission/DATA/Hoc_";
                %----------------------------------------------------------
                xlim       = [-100, 100];
                xtick      =-100:50:100;
                xticklabel = ["-100", "-50", "0", "50", "100"];
                %----------------------------------------------------------
            case 7
                %----------------------------------------------------------
                path       = "Plot/T07 - Wall/DATA/Wall_";
                %----------------------------------------------------------
                xlim       = [-100, 0];
                xtick      = -100:25:0;
                xticklabel = ["-100", "-75", "-50", "-25", "0"];
                %----------------------------------------------------------
        end
        switch g.data.opt
            case 1
                %----------------------------------------------------------
                ylim       = [-0.45, 2.65];
                ytick      = [-0.45, 0.00:0.50:2.50, 2.65];
                yticklabel = ["-0.45", "0.00", "0.50", "1.00", "1.50", "2.00", "2.50", "2.65"];
                %----------------------------------------------------------
            case 2
                %----------------------------------------------------------
                ylim       = [-0.05, 0.45; -0.05, 0.05; -0.15, 0.15; -0.005, 0.005];
                ytick      = {[-0.05, 0.00:0.10:0.40, 0.45]; -0.050:0.025:0.050; -0.15:0.05:0.15; -0.0050:0.0025:0.0050};
                yticklabel = {["-0.05", "0.00", "0.10", "0.20", "0.30", "0.40", "0.45"];
                    ["-0.050", "-0.025", "0.000", "0.025", "0.050"];
                    ["-0.15", "-0.10", "-0.05", "0.00", "0.05", "0.10", "0.15"];
                    ["-0.0050", "-0.0025", "0.0000", "0.0025", "0.0050"]};
                %----------------------------------------------------------
            otherwise
                return
        end
        %------------------------------------------------------------------
        xtitle      = "$x$";
        ytitle      = "";
        legendlabel = [...
            "$\zeta_{a}^{\prime}$", "$\zeta_{h}^{\prime}$";
            "$\Phi_{a}$", "$\Phi_{h}$";
            "$h\nabla\zeta_{a}$", "$h\nabla\zeta_{h}$";
            "$h\mathcal{Q}_{a}^{1}$", "$h\mathcal{Q}_{h}^{1}$"];
        numcols     = 1;
        %------------------------------------------------------------------
    case 8
        %------------------------------------------------------------------
        path        = "Plot/T08 - Overtaking colission/DATA/Oc_";
        %------------------------------------------------------------------
        xlim        = [-200, 200];
        xtick       =-200:50:200;
        xticklabel  = ["-200", "-150", "-100", "-50", "0", "50", "100", "150", "200"];
        %------------------------------------------------------------------
        ylim        = [-0.25, 2.50];
        ytick       = [-0.25, 0.00:0.50:2.50];
        yticklabel  = ["-0.25", "0.00", "0.50", "1.00", "1.50", "2.00", "2.50"];
        %------------------------------------------------------------------
        xtitle      = "$x$";
        ytitle      = "$z^{\prime}$";
        legendlabel = ["$\zeta_{a}^{\prime}$", "$\zeta_{h}^{\prime}$"];
        numcols     = 1;
        %------------------------------------------------------------------
    case 9
        %------------------------------------------------------------------
        path        = "Plot/T09 - Breakup of a Gaussian hump/DATA/Bgh_";
        %------------------------------------------------------------------
        xlim        = [-100, 100];
        xtick       =-100:50:100;
        xticklabel  = ["-100", "-50", "0", "50", "100"];
        %------------------------------------------------------------------
        switch g.data.opt
            case 1
                %----------------------------------------------------------
                ylim       = [-0.25, 1.65];
                ytick      = [-0.25, 0.00:0.50:1.50, 1.65];
                yticklabel = ["-0.25", "0.00", "0.50", "1.00", "1.50", "1.65"];
                %----------------------------------------------------------
            case 2
                %----------------------------------------------------------
                ylim       = [-0.45, 2.10];
                ytick      = [-0.45, 0.00:0.50:2.10];
                yticklabel = ["-0.45", "0.00", "0.50", "1.00", "1.50", "2.00", "2.10"];
                %----------------------------------------------------------
            otherwise
                return
        end
        %------------------------------------------------------------------
        xtitle      = "$x$";
        ytitle      = "$\zeta^{\prime}$";
        %------------------------------------------------------------------
    case 10
        %------------------------------------------------------------------
        path        = "Plot/T10 - Dispersive dam-break/DATA/Ddb_";
        %------------------------------------------------------------------
        xlim        = [-300, 300];
        xtick       =-300:100:300;
        xticklabel  = ["-300", "-200", "-100", "0", "100", "200", "300"];
        %------------------------------------------------------------------
        ylim        = [0.95, 2.00];
        ytick       = [0.95, 1.00:0.25:2.00];
        yticklabel  = ["0.95", "1.00", "1.25", "1.50", "1.75", "2.00"];
        %------------------------------------------------------------------
        xtitle      = "$x$";
        ytitle      = "$h$";
        legendlabel = ["$h_{0}$", "$h$"];
        %------------------------------------------------------------------
    case 11
        %------------------------------------------------------------------
        path        = sprintf("Plot/T11 - Reversibility check/DATA/C%d/Shelf_", g.data.bathy);
        %------------------------------------------------------------------
        xlim        = [0, 240];
        xtick       = [0, 40, 80, 120, 160, 200, 240];
        xticklabel  = ["0", "40", "80", "120", "160", "200", "240"];
        %------------------------------------------------------------------
        ylim        = [-0.02, 0.35];
        ytick       = [-0.02, 0.00:0.05:0.35];
        yticklabel  = ["-0.02", "0.00", "0.05", "0.10", "0.15", "0.20", "0.25", "0.30", "0.35"];
        %------------------------------------------------------------------
        xtitle      = "$x$";
        ytitle      = "$\zeta^{\prime}$";
        legendlabel = ["$\zeta_{a}^{\prime}$", "$\zeta_{h}^{\prime}$"];
        numcols     = 1;
        %------------------------------------------------------------------
    case 12
    case 13
        %------------------------------------------------------------------
        path        = "Plot/T13 - Oscillating lake/DATA/Ol_";
        %------------------------------------------------------------------
        xlim        = [-1.5, 1.5];
        xtick       =-1.5:0.5:1.5;
        xticklabel  = ["-1.5", "-1.0", "-0.5", "0.0", "1.0", "1.5"];
        %------------------------------------------------------------------
        ylim        = [0.00, 0.25];
        ytick       = 0.00:0.05:0.25;
        yticklabel  = ["0.00", "0.05", "0.10", "0.15", "0.20", "0.25"];
        %------------------------------------------------------------------
        xtitle      = "$x$";
        ytitle      = "$\zeta$";
        legendlabel = ["$\zeta_{a}$", "$\zeta_{h}$"];
        numcols     = 1;
        %------------------------------------------------------------------
    case 14
        %------------------------------------------------------------------
        path        = "Plot/T14 - Lake at rest/DATA/L_";
        %------------------------------------------------------------------
        xlim        = [-3, 3];
        xtick       =-3:1:3;
        xticklabel  = ["-3.0", "-2.0", "-1.0", "0.0", "1.0", "2.0", "3.0"];
        %------------------------------------------------------------------
        ylim        = [0.00, 0.50];
        ytick       = 0.00:0.10:0.50;
        yticklabel  = ["0.05", "0.10", "0.20", "0.30", "0.40", "0.50"];
        %------------------------------------------------------------------
        xtitle      = "$x$";
        ytitle      = "$\zeta$";
        %------------------------------------------------------------------
    case 15
        %------------------------------------------------------------------
        path        = "Plot/T15 - Synolakis/DATA/S_";
        %------------------------------------------------------------------
        %
        xlim        = [-10, 20];
        xtick       =-10:5:20;
        xticklabel  = ["-10", "-5", "0", "5", "10", "15", "20"];
        %
%         xlim        = [0, 12];
%         xtick       = 0:2:12;
%         xticklabel  = ["0", "2", "4", "6", "8", "10", "12"];
        %
        %------------------------------------------------------------------
        switch g.data.opt
            case 1
                %----------------------------------------------------------
                %
                ylim       = [-0.10, 0.25];
                ytick      = (-0.10:0.05:0.25);
                yticklabel = ["-0.10", "-0.05", "0.00", "0.05", "0.10", "0.15", "0.20", "0.25"];
                %
%                 ylim       = [0, 14];
%                 ytick      = 0:2:14;
%                 yticklabel = ["0", "2", "4", "6", "8", "10", "12", "14"];
                %
                %----------------------------------------------------------
            case 2
                %----------------------------------------------------------
                ylim       = [-0.10, 0.25];
                ytick      =-0.10:0.05:0.25;
                yticklabel = ["-0.10", "-0.05", "0.00", "0.05", "0.10", "0.15", "0.20", "0.25"];
                %----------------------------------------------------------
            case 3
                %----------------------------------------------------------
                ylim       = [-0.10, 0.40];
                ytick      =-0.10:0.10:0.40;
                yticklabel = ["-0.10", "0.00", "0.10", "0.20", "0.30", "0.40"];
                %----------------------------------------------------------
            otherwise
                return
        end
        %------------------------------------------------------------------
        xtitle      = "$x$";
        ytitle      = "$\zeta^{\prime}$";
        %------------------------------------------------------------------
    case 16
        %------------------------------------------------------------------
        path        = "Plot/T16 - Drying of a lake/DATA/Dl_";
        %------------------------------------------------------------------
        xlim        = [-0.20, 0.20];
        xtick       =-0.20:0.10:0.20;
        xticklabel  = ["-0.20", "-0.10", "0.00", "0.10", "0.20"];
        %------------------------------------------------------------------
        ylim        = [0.0, 0.8];
        ytick       = 0.0:0.2:0.8;
        yticklabel  = ["0.0", "0.2", "0.4", "0.6", "0.8"];
        %------------------------------------------------------------------
        xtitle      = "$x$";
        ytitle      = "$\zeta$";
        %------------------------------------------------------------------
    case 17
        %------------------------------------------------------------------
        path        = "Plot/T17 - Wave generation/DATA/Wg_";
        %------------------------------------------------------------------
        xlim        = [0, 100];
        xtick       = 0:20:100;
        xticklabel  = ["0", "20", "40", "60", "80", "100"];
        %------------------------------------------------------------------
        ylim        = [-0.015, 0.015];
        ytick       = [-0.015, 0.000, 0.015];
        yticklabel  = ["-0.015", "0.000", "0.015"];
        %------------------------------------------------------------------
        xtitle      = "$x$";
        ytitle      = "$\zeta$";
        %------------------------------------------------------------------
    otherwise
        return
end
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
h0 = g.data.h0;
Ha = g.data.H(xc, 0);
Za = g.data.Z(xc, 0);
H_ = sum(pagemtimes(g.x(:, :, 1)-g.zbinit, g.Wbf'), 2)./sum(g.W, 2);
Z_ = sum(pagemtimes(g.x(:, :, 1)         , g.Wbf'), 2)./sum(g.W, 2);
if test ~= 13 && test ~= 14 && test ~= 16
    Za = Za./h0;
    Z_ = Z_./h0;
end
%--------------------------------------------------------------------------
if test ~= 7
    %----------------------------------------------------------------------
    ph = cell(1, 2);
    Ph = cell(1, 2);
    %----------------------------------------------------------------------
    %if test ~= 17
        figure('Color', 'w', 'Renderer', 'painters', 'Windowstate', 'maximized');
        hold on;
        PlotX1(...
            xlim, ylim, ...
            xtick, ytick, ...
            xticklabel, yticklabel, ...
            xtitle, ytitle);
    %end
    %----------------------------------------------------------------------
    if ismembc(test, [6, 8, 12, 13])
        if test == 12
            patch(...
                [0.0, 1.0, 1.0   ], ...
                [0.0, 0.0, 20./30], grey, 'EdgeColor', grey);
        elseif test == 13
            xbathy = linspace(xv(1, 1), xv(K+1, 1), 1000);
            ybathy = g.data.Zb(xbathy);
            patch(...
                [xv(1, 1), xbathy, xv(K+1, 1)], [0, ybathy, 0], grey, 'EdgeColor', grey);
        end
        ph{1, 1} = plot(nan, nan, 'Color', Color(1, :), 'LineWidth', LW(1, 1));
        ph{1, 2} = plot(nan, nan, 'Color', Color(2, :), 'LineWidth', LW(1, 2));
        Ph{1, 1} = plot(xc , Za , 'Color', Color(1, :), 'LineWidth', LW(1, 1));
        Ph{1, 2} = plot(xc , Z_ , 'Color', Color(2, :), 'LineWidth', LW(1, 2));
        PlotX2(...
            ph(1, :), legendlabel, 'northeast', numcols);
    elseif ismembc(test, [9, 11, 14, 15, 16, 17])
        if test == 15
            patch(...
                [xlim(1, 1), xlim(1, 1), -19.85.*ylim(1, 1)], [ylim(1, 1), -xlim(1, 1)./19.85, ylim(1, 1)], grey, 'EdgeColor', grey);
        end
        if test == 14 || test == 16
            %{
            xbathy = linspace(-0.5, 0.5, 1000);
            ybathy = g.data.Zb(xbathy, 0);
            patch(...
                xbathy, ybathy, grey, 'EdgeColor', grey);
            %}
            xbathy = sum(g.coordV0T, 2)./2;
            ybathy = meanval(g, g.zbinit);
            patch(...
                xbathy, ybathy, grey, 'EdgeColor', grey);
        end
        if test == 17
            xline(10.00, '--', 'Color', 'k');
            xline(60.00, '--', 'Color', 'k');
            yline(-0.01,  ':', 'Color', 'r');
            yline( 0.01,  ':', 'Color', 'r');
        end
        Ph{1, 2} = plot(xc , Z_ , 'Color', Color(2, :), 'LineWidth', LW(1, 2));
    elseif test == 10
        ph{1, 1} = plot(nan, nan, 'Color', Color(1, :), 'LineWidth', LW(1, 1));
        ph{1, 2} = plot(nan, nan, 'Color', Color(2, :), 'LineWidth', LW(1, 2));
        Ph{1, 1} = plot(xc , Ha , 'Color', Color(2, :), 'LineWidth', LW(1, 1));
        Ph{1, 2} = plot(xc , H_ , 'Color', Color(2, :), 'LineWidth', LW(1, 2));
        PlotX2(...
            ph(1, :), legendlabel, 'northeast', numcols);
    end
    %----------------------------------------------------------------------
else
    %----------------------------------------------------------------------
    ph = cell(4, 2);
    Ph = cell(4, 2);
    %----------------------------------------------------------------------
    for i = 1:2
        figure('Color', 'w', 'Renderer', 'painters', 'Windowstate', 'maximized');
        for j = 1:2
            k = 2*(i-1)+j;
            %--------------------------------------------------------------
            subplot(1, 2, j);
            hold on;
            PlotX1(...
                xlim, ylim(k, :), ...
                xtick, ytick{k, 1}, ...
                xticklabel, yticklabel{k, 1}, ...
                xtitle, ytitle);
            %--------------------------------------------------------------
            ph{k, 1} = plot(nan, nan, 'Color', Color(1, :), 'LineWidth', LW(1, 1));
            ph{k, 2} = plot(nan, nan, 'Color', Color(2, :), 'LineWidth', LW(1, 2));
            if i == 1 && j == 1
                Ph{k, 1} = plot(xc, Za, 'Color', Color(1, :), 'LineWidth', LW(1, 1));
                Ph{k, 2} = plot(xc, Z_, 'Color', Color(2, :), 'LineWidth', LW(1, 2));
            else
                Ph{k, 1} = plot(xc, zeros(K, 1), 'Color', Color(1, :), 'LineWidth', LW(1, 1));
                Ph{k, 2} = plot(xc, zeros(K, 1), 'Color', Color(2, :), 'LineWidth', LW(1, 2));
            end
            PlotX2(...
                ph(k, :), legendlabel(k, :), 'northeast', numcols);
            %--------------------------------------------------------------
        end
    end
    %----------------------------------------------------------------------
end
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
str2 = split(sprintf('%.15g', CFL), '.');
%--------------------------------------------------------------------------
switch test
    case {6, 7}
        switch g.data.opt
            case 1
                num1 = '_96';
            case 2
                num1 = '_21';
            otherwise
                return
        end
    case {8, 10, 11, 13, 14, 16, 17}
        num1 = '';
    case 9
        switch g.data.opt
            case 1
                num1 = '_01';
            case 2
                num1 = '_20';
            otherwise
                return
        end
    case 15
        switch g.data.opt
            case 1
                num1 = '_019';
            case 2
                num1 = '_040';
            case 3
                num1 = '_280';
            otherwise
                return
        end
    otherwise
        return
end
if numel(str2) < 2
    num2 = '0000';
else
    num2 = [str2{2}, '0000'];
    num2 = num2(1, 1:2);
end
%--------------------------------------------------------------------------
fid = sprintf('%sP%d%s_%s_GN.mat', path, g.p, num1, num2);
if isfile(fid)
    delete(fid);
end
nf  = g.data.nf+1;
ndt = g.data.tend./g.data.nf;
obj = Output(Ph, fid, ndt, nf, K, N, 0, xc, nan, nan, nan);
%--------------------------------------------------------------------------
obj.Write1(0, g.x, 0);
obj.Write2(0, g.x, nan, 0);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
end