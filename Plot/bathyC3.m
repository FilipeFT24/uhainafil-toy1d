function [f] = bathyC3(slope, ds, flag)
d1 =-ds;
d2 = ds;
A  = [...
    d1.^[7, 6, 5, 4, 3, 2, 1, 0].*[  1,   1,  1,  1, 1, 1, 1, 1];
    d1.^[6, 5, 4, 3, 2, 1, 0, 0].*[  7,   6,  5,  4, 3, 2, 1, 0];
    d1.^[5, 4, 3, 2, 1, 0, 0, 0].*[ 42,  30, 20, 12, 6, 2, 0, 0];
    d1.^[4, 3, 2, 1, 0, 0, 0, 0].*[210, 120, 60, 24, 6, 0, 0, 0];
    d2.^[7, 6, 5, 4, 3, 2, 1, 0].*[  1,   1,  1,  1, 1, 1, 1, 1];
    d2.^[6, 5, 4, 3, 2, 1, 0, 0].*[  7,   6,  5,  4, 3, 2, 1, 0];
    d2.^[5, 4, 3, 2, 1, 0, 0, 0].*[ 42,  30, 20, 12, 6, 2, 0, 0];
    d2.^[4, 3, 2, 1, 0, 0, 0, 0].*[210, 120, 60, 24, 6, 0, 0, 0]];
switch flag
    case 1
        b = [0; 0; 0; 0; +slope.*ds; +slope; 0; 0]; % _/
    case 2
        b = [+slope.*ds; -slope; 0; 0; 0; 0; 0; 0]; % \_
    case 3
        b = [-slope.*ds; +slope; 0; 0; 0; 0; 0; 0]; % /-
    case 4
        b = [0; 0; 0; 0; -slope.*ds; -slope; 0; 0]; % -\
    otherwise
        return
end
x  = A\b;
f  = @(y) ...
    x(1, 1).*y.^7+...
    x(2, 1).*y.^6+...
    x(3, 1).*y.^5+...
    x(4, 1).*y.^4+...
    x(5, 1).*y.^3+...
    x(6, 1).*y.^2+...
    x(7, 1).*y.^1+...
    x(8, 1);
end